variable TEMP		equal   310.0
variable PRESS 		equal   0.0
variable RUNTIME	equal   250000000         # (250x1e6 timesteps)
variable RESTART        equal   ${RUNTIME}/25  	  # frequency of writing restart file
variable dumptrj	equal	1000000

variable SEED  		equal  	12392
variable SEED2   	equal   $( v_SEED + 1099 )
variable SEED3  	equal   $( v_SEED + 80192 ) 
variable SEED4  	equal   $( v_SEED + 7102 )
variable SEED5 		equal   $( v_SEED + 30192 )

include 		"system.init"
	
#########		READ DATA FILE ######################
read_data		Capsid_LEN.data

variable LN             equal  -8.50
variable LN1            equal  -6.25

include                 "Capsid_intra.ff"
include			"Capsid_assembly.ff"
include			"CA-LEN.ff"

timestep  		50.0 			#timestep of 50 fs

group			Capsid type <> 1 92
group                   LEN type <> 93 100

group			mobile union Capsid LEN

neigh_modify            exclude molecule/intra Capsid
neigh_modify            exclude molecule/intra LEN

comm_style 		tiled
comm_modify             mode single cutoff 70.0

compute                 1 Capsid pair gauss/wall

thermo       		10000
thermo_style            custom step spcpu temp ke pe etotal epair enthalpy c_1 
thermo_modify           flush yes

fix                     m1 Capsid momentum 100000 linear 1 1 1 angular
fix                     b1 Capsid balance 100000 1.2 rcb

fix                     3 Capsid nve
fix 			4 Capsid langevin ${TEMP} ${TEMP} 500000.0 ${SEED3} zero yes

fix			5 LEN rigid/nve/small molecule langevin ${TEMP} ${TEMP} 500000.0 ${SEED4}

dump            	1 all custom ${dumptrj} Capsid.lammpstrj id mol type xs ys zs 
dump_modify 		1 sort id

restart                 ${RESTART} config
run 			${RUNTIME}

write_data 		eq0.data nocoeff

